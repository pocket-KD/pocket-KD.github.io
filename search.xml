<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[CentOS 7 搭建dns服务器]]></title>
    <url>%2F2019%2F06%2F03%2FCentOS%207%20%E6%90%AD%E5%BB%BADNS%E6%9C%8D%E5%8A%A1%E5%99%A8%2F</url>
    <content type="text"><![CDATA[####环境：DNS服务器：CentOS 7Client：kaliDNS Server：192.168.110.43域名：test.com ####关闭防火墙:systemctl stop firewalld; –临时关闭防火墙systemctl disable firewalld; –永久关闭防火墙 ####关闭selinux：临时关闭：setenforce 0永久关闭：vim /etc/selinux/configSELINUX=disabled reboot ####（1）在DNS服务器上安装BINDyum -y install bind*（安装过显示“无需任何处理”）安装好后查看r软件包rpm -qa | grep ^bind ####（2）启动DNS服务 systemctl start named.service –启动DNS服务 systemctl enable named.service –设置为开机启动 netstat -anlp | grep named –查看监听端口为53named默认监听TCP、UDP协议的53端口，以及TCP的539端口：其中UDP53端口一般对所有客户及开放，以提供解析服务；TCP53端口一般只对特定从域名服务器开放，提高解析记录传输通道；TCP953端口默认只对本机开放，用于为rndc远程管理工具提供控制通道。 #####配置文件的目录：没有安装bind-chroot软件包配置文件为/etc/named.conf数据文件在/var/named目录下 安装了bind-chroot软件包配置文件为/var/named/chroot/etc/named.conf –默认没有数据文件在/var/named/chroot/var/named目录 ####（3）域名服务器的配置配置步骤：编辑/etc/named.rfc1912.zones –记录你的域和域对应的数据文件在哪编辑/var/named/data/*.zone –就是数据文件，记录域名和IP的对应 正向解析（将域名解析成IP） #####1）修改DNS服务的配置文件vim /etc/named/confoptions { listen-on port 53 { 192.168.110.43; }; # 将127.0.0.1改为本机IP：192.168.110.43 listen-on-v6 port 53 { ::1; }; directory “/var/named”; dump-file “/var/named/data/cache_dump.db”; statistics-file “/var/named/data/named_stats.txt”; memstatistics-file “/var/named/data/named_mem_stats.txt”; allow-query { any; }; # 将localhost改为any,表示所有人都能对我的DNS服务进行查询 #####2）添加域的信息写在子配置文件vim /etc/named.rfc1912.zones –文件最后添加正向解析数据文件的信息zone “test.com” IN { type master; file “data/test.com.zone”; }; #####3）编辑正向解析文件vim /var/named/data/test.com.zone –编辑正向解析文件（将域名解析成IP）$TTL 1D # 缓存时间 @ IN SOA dns.test.com. dns.www.test.com. ( 20190629 ; serial 1D ; refresh 1H ; retry 1W ; expire 3H ) ; minimum @ IN NS dns.test.com. # DNS服务器的域名地址 dns.test.com. IN A 192.168.110.43 # DNS服务器的IP地址 @ IN MX 10 mail.www.test.com. # 邮件服务器的域名地址 mail.www.test.com. IN A 192.168.8.4 # 邮件服务器IP地址 www.test.com. IN A 192.168.110.43 # 域名为test.com的IP地址 ftp.test.com. IN A 192.168.8.3 # 域名为ftp的IP地址 ####（4）客户端测试正向解析（客户端必要能跟服务器端通信及关闭selinux）vim /etc/resolv.conf –修改客户的DNS服务器nameserver 192.168.110.43 –IP为服务器的IP dig www.test.comnslooup www.test.comhost www.test.com 正向解析成功！ ####（5）客户端测试 #####1）修改DNS服务的配置文件 vim /etc/named.rfc1912.zones –文件最后添加反向解析数据文件的信息 #####2）编辑反向解析文件vim /var/named/data/192.168.110.zone$TTL 1D @ IN SOA dns.test.com. dns.www.test.com. ( 20190629 ; serial 1D ; refresh 1H ; retry 1W ; expire 3H ) ; minimum @ IN NS dns.test.com. 43 IN PTR dns.test.com. @ IN MX 10 mail.www.test.com. 4 IN PTR mail.www.test.com. 43 IN PTR www.test.com. 3 IN PTR ftp.test.com. systemctl restart named.service –重启服务 3）测试 nslookup 192.168.110.43host 192.168.110.43 解析成功！！]]></content>
      <tags>
        <tag>服务篇</tag>
      </tags>
  </entry>
</search>
